
\section{几何不等式}
\label{sec:geometric-inequality}

\subsection{基本不等式}
\label{sec:basic-geometric-inequality}

\begin{theorem}
  平面上两点间直线段长度最短。
\end{theorem}

\begin{example}
  平面上凸四边形$ABCD$，$M,N$分别是$AD$和$BC$的中点，则
  \begin{align*}
    MN\le\frac{AB+CD}{2}
  \end{align*}
  当且仅当$AB\parallel CD$时等号成立。

  \centering
  \begin{tikzpicture}[scale=1.0,line join=round]
    \begin{scope}[shift={(0,0)}]
      \coordinate[label=below left:$A$]  (A) at (0,0);
      \coordinate[label=below right:$B$] (B) at (5,0);
      \coordinate[label=above right:$C$] (C) at (4,4);
      \coordinate[label=above left:$D$]  (D) at (2,3);
      \coordinate[label=left:$M$]        (M) at ($.5*(A)+.5*(D)$);
      \coordinate[label=right:$N$]       (N) at ($.5*(B)+.5*(C)$);
      % \coordinate[label=below:$P$] (P) at ($.5*(D)+.5*(B)$);
      \draw(A)--(B)--(C)--(D)--cycle;
      \draw(M)--(N);%--(P)--cycle;
      %\draw(D)--(B);
      \tkzDrawPoints(A,B,C,D,M,N);
    \end{scope}
    \begin{scope}[shift={(7,0)}]
      \coordinate[label=below left:$A$]  (A) at (0,0);
      \coordinate[label=below right:$B$] (B) at (5,0);
      \coordinate[label=above right:$C$] (C) at (4,4);
      \coordinate[label=above left:$D$]  (D) at (2,3);
      \coordinate[label=left:$M$]        (M) at ($.5*(A)+.5*(D)$);
      \coordinate[label=right:$N$]       (N) at ($.5*(B)+.5*(C)$);
      \coordinate[label=below right:$P$] (P) at ($.5*(D)+.5*(B)$);
      \draw(A)--(B)--(C)--(D)--cycle;
      \draw(M)--(N);
      \draw[help lines, dashed](M)--(P)--(N);
      \draw[help lines, dashed](D)--(B);
      \tkzDrawPoints(A,B,C,D,M,N,P);
    \end{scope}
  \end{tikzpicture}
\end{example}
\begin{proof}
  如图取$BD$的点$P$并作辅助线，则
  \begin{align*}
    MN\le MP+NP=\frac{AB+CD}{2}
  \end{align*}
  当且仅当点$P$在$MN$上时等号成立，而$P$在$MN$上时等价于$AB\parallel CD$。
\end{proof}

\begin{theorem}[Pythagorean不等式]
  记三角形的三边分别为$a\le b\le c$，则
  \begin{enumerate}
  \item 三角形是直角三角形$\iff a^2+b^2=c^2$；
  \item 三角形是锐角三角形$\iff a^2+b^2>c^2$；
  \item 三角形是钝角三角形$\iff a^2+b^2<c^2$。
  \end{enumerate}
\end{theorem}
\begin{proof}
  由余弦定理$c^2=a^2+b^2-2ab\cos\mathrm{C}$可得。
\end{proof}


\begin{theorem}[等周不等式，Isoperimetric Inequality]
  若一个平面图形的面积与周长分别为$A$和$P$，则$4\pi A\le P^2$。也就是说在平面上用长度为$P$的线段能围成的最大面积是半径为$\dfrac{P}{2\pi}$的圆，其面积为$\dfrac{P^2}{4\pi}$。
\end{theorem}
\begin{proof}[提示]
  该定理的证明并不平凡，
\end{proof}

\begin{theorem}[三角不等式，Trigonometric Inequality]
  记三角形的三个角分别为$A,B,C$，则
  \begin{align*}
    \sin A +\sin B + \sin C&\le\frac{3\sqrt3}{2}\\
    \cos A +\cos B + \cos C&\le\phantom{3}\,\frac{3}{2}
  \end{align*}
\end{theorem}
\begin{proof}
  由$\sin(x)$及$\cos(x)$在$[0,\pi]$上是凹函数，利用Jensen不等式可得。
\end{proof}

\begin{theorem}[相交弦定理，Intersecting Chords Theorem]
  圆内的两条相交弦，被交点分成的两条线段长的积相等。
\end{theorem}
\begin{proof}
  利用相似三角形可得。
\end{proof}

\begin{theorem}[海伦公式，海伦-秦九韶公式，Heron's Formula]
  记三角形的三边边长分别为$a,b,c$，其半周长$s=\dfrac{a+b+c}2$，则三角形的面积为
  \begin{align}
    S=\sqrt{s(s-a)(s-b)(s-c)}
  \end{align}
\end{theorem}
\begin{proof}
  用余弦公式可证。或者用勾股定理证明$c$边对应的高
  \begin{align*}
    h=\frac{4s(s-a)(s-b)(s-c)}{c^2} &\qedhere
  \end{align*}
\end{proof}

\begin{theorem}
  如图~\ref{fig:r-of-incircle}所示，三角形内切圆将各边分别分割成$x,y,z$的长度，则可得到内切圆的半径公式
  \begin{align}
    r=\sqrt{\frac{xyz}{x+y+z}}=\frac{S}{s}
  \end{align}
\end{theorem}
\begin{figure}[htbp]
  \centering
  \begin{tikzpicture}[scale=1]
    \tkzDefPoint[label=below left:$A$](0,0){A}
    \tkzDefPoint[label=below right:$B$](6,0){B}
    \tkzDefPoint[label=above:$C$](5,5){C}
    
    \tkzDefCircle[in](A,B,C)\tkzGetPoint{I}\tkzGetLength{rIN}
    \tkzDrawCircle[R](I,\rIN pt);
    \tkzDrawSegments(A,B B,C C,A)
    % \tkzDrawSegments[dashed](I,A I,B I,C)

    \coordinate(IA) at ($(B)!(I)!(C)$);
    \coordinate(IB) at ($(C)!(I)!(A)$);
    \coordinate(IC) at ($(A)!(I)!(B)$);

    %\tkzDrawSegments[dashed](I,IA I,IB I,IC)
    \tkzMarkRightAngle[color=blue](B,IC,I)
    \tkzMarkRightAngle[color=blue](C,IA,I)
    \tkzMarkRightAngle[color=blue](A,IB,I)

    \foreach \p in{A,B,C,I,IA,IB,IC}{
      \tkzDrawPoint(\p)
    }
    \tkzLabelPoints[below left](I)

    \draw(A)--(IC) node[below,sloped,midway]{$x$};
    \draw(A)--(IB) node[above left,sloped,midway]{$x$};
    \draw(B)--(IC) node[below,sloped,midway]{$y$};
    \draw(B)--(IA) node[above right,sloped,midway]{$y$};
    \draw(C)--(IB) node[above left,sloped,midway]{$z$};
    \draw(C)--(IA) node[above right,sloped,midway]{$z$};
    \draw[dashed](I)--(IC);
    \draw[dashed](I)--(IA) node[above,sloped,midway]{$r$};
    \draw[dashed](I)--(IB);% node[below left,sloped,midway]{$r$};
  \end{tikzpicture}
  \caption{三角形内切圆的半径}
  \label{fig:r-of-incircle}
\end{figure}
\begin{proof}
  令$s=\dfrac{a+b+c}2$是半周长，则显然有$x=s-a, y=s-b, z=s-c$。由海伦公式可得
  \begin{align*}
    S=\sqrt{xyz(x+y+z)}
  \end{align*}
  另一方面，$S=\dfrac12r(a+b+c)=r(x+y+z)$，从而可得。
\end{proof}

\begin{theorem}[Euler定理]
  记$R,r$分别是三角形的外接圆和内切圆半径，$d$是外接圆与内切圆圆心间的距离，则$d^2=R(R-2r)$，或等价的
  \begin{align*}
    \frac1{R-d}+\frac1{R+d}=\frac1r
  \end{align*}
\end{theorem}
\begin{proof}
  记$G,I$分别是外接圆和内切圆的圆心，在过$G$和$I$的直线上找到长度分别为$R+d$和$R-d$的线段，比如直线$GI$与外接圆的交点$P$、$Q$，则线段$IP$和$IQ$分别为$R\pm d$。

  如图\ref{fig:in/circumcircle}，延长$CI$得$L$，延长$LG$得$M$，延长$GI$得$P$和$Q$，则$\triangle CID\sim\triangle MLA$，且$LA=LI$，从而
  \begin{align*}
    (R+d)(R-d)&=IP\cdot IQ=IC\cdot IL=IC\cdot LA=ID\cdot LM=2Rr&\qedhere
  \end{align*}
\end{proof}

\begin{figure}[htbp]
  \centering
%\fbox{%Use \fbox to check the boundary of the tikz picture
  \begin{tikzpicture}[scale=1]
    \tkzDefPoint[label=below left:$A$](0,0){A}
    \tkzDefPoint[label=below right:$B$](6,0){B}
    \tkzDefPoint[label=above:$C$](5,5){C}
    
    \tkzDefCircle[in](A,B,C)\tkzGetPoint{I}\tkzGetLength{rIN}
    \tkzDrawCircle[R](I,\rIN pt);
    \tkzDrawSegments(A,B B,C C,A)
    % \tkzDrawSegments[dashed](I,A I,B I,C)

    % \coordinate(IA) at ($(B)!(I)!(C)$);
    \coordinate[label=above left:$D$](IB) at ($(C)!(I)!(A)$);
    % \coordinate(IC) at ($(A)!(I)!(B)$);

    % \tkzDrawSegments[dashed](I,IA I,IB I,IC)
    \tkzDrawSegments[dashed](I,IB)
    % \tkzMarkRightAngle[color=blue](B,IC,I)
    % \tkzMarkRightAngle[color=blue](C,IA,I)
    \tkzMarkRightAngle[color=blue](A,IB,I)

    % circumcircle
    \tkzCircumCenter(A,B,C)\tkzGetPoint{G}
    \tkzDrawCircle(G,A)
    \tkzInterLC(G,I)(G,A)\tkzGetPoints{P}{Q}

    \draw[dashed](A)--(I);
    \draw[dashed](I)--(P);
    \draw[dashed](I)--(Q);
    \draw[thick](G)--(I);

    \tkzInterLC(C,I)(G,A)\tkzGetPoints{}{L}
    \tkzInterLC(L,G)(G,A)\tkzGetPoints{}{M}

    \tkzLabelPoints[left](P)
    \tkzLabelPoints[right](Q,I)
    \tkzLabelPoints[below](L)
    \tkzLabelPoints[below left](G)
    \tkzLabelPoints[above](M)

    \draw[dashed](C)--(L)--(M)--(A)--(L);

    \foreach \p in{A,B,C,I,G,P,Q,IB,L,M}{
      \tkzDrawPoint(\p)
    }

    % emphasize similar triangles
    \draw[very thick](C)--(I)--(IB)--cycle;
    \draw[very thick](M)--(A)--(L)--cycle;
  \end{tikzpicture}
%}
  % Maybe due to BUG of pgfplots, there're wide space between figure
  % and caption, -3cm is measured by eye
  \vspace*{-3cm}
  \caption{三角形的外接圆与内切圆}
  \label{fig:in/circumcircle}
\end{figure}


\begin{theorem}[Euler不等式]
  记$R,r$分别是三角形$\triangle ABC$的外接圆和内切圆半径，则有$R\ge2r$。
\end{theorem}
\begin{proof}
  由Euler定理立得。
\end{proof}

\begin{theorem}\label{th:R-of-circumcircle}
  任意$\triangle ABC$，其三边边长分别为$a,b,c$，面积为$S$，则其外接圆半径为
  \begin{align}
    R=\frac{abc}{4S}
  \end{align}
\end{theorem}
\begin{figure}[htbp]
  \centering
  \begin{tikzpicture}[scale=1]
    \tkzDefPoint[label=below left:$A$](0,0){A}
    \tkzDefPoint[label=below right:$B$](6,0){B}
    \tkzDefPoint[label=above:$C$](5,5){C}
    
    % circumcircle
    \tkzCircumCenter(A,B,C)\tkzGetPoint{G}
    \tkzDrawCircle(G,A)
    \tkzLabelPoints[below left](G)

    \coordinate[label=above right:$D$](D) at ($(B)!(G)!(C)$);

    \draw[dashed](B)--(G) node[midway,below left]{$R$};
    \draw[dashed](C)--(G);
    \draw[dashed](D)--(G);
    \tkzMarkRightAngle[color=blue](G,D,B)
    \draw(A)--(B)--(C)
        node[pos=0.20,above right]{$\dfrac{a}2$} 
        node[pos=0.65,above right]{$\dfrac{a}2$} --cycle;

    \draw pic["$\alpha$",draw=orange,<->,angle eccentricity=1.6,angle radius=.6cm] {angle=B--A--C};
    \draw pic["$\alpha$",draw=orange,<->,angle eccentricity=1.6,angle radius=.6cm] {angle=B--G--D};
    \draw pic["$\alpha$",draw=orange,<->,angle eccentricity=1.6,angle radius=.6cm] {angle=D--G--C};

    \foreach \p in{A,B,C,D,G}{
      \tkzDrawPoint(\p)
    }
  \end{tikzpicture}    
  % Maybe due to BUG of pgfplots, there're wide space between figure
  % and caption, -3cm is measured by eye
  \vspace*{-3.5cm}
  \caption{三角形外接圆半径}
  \label{fig:R-of-circumcircle}
\end{figure}
\begin{proof}
  由图~\ref{fig:R-of-circumcircle}容易看出$\angle BAC = \angle CGD = \angle BGD$，从而有
  \begin{align*}
    S_{\triangle ABC} = \frac12 bc\cdot\sin\angle BAC
    = \frac12 bc \cdot \frac{a/2}{R} = \frac{abc}{4R}
  \end{align*}
  从而可算出$R$。
\end{proof}


\begin{theorem}
  任意$\triangle ABC$，记$a,b,c$是其三边边长，$r,R$分别是其内切圆与外接圆半径，则
  \begin{align}
    rR=\frac{abc}{2(a+b+c)}
  \end{align}
\end{theorem}
\begin{proof}
  在定理~\ref{th:R-of-circumcircle}，将$r=\dfrac{S}{s}$及$a+b+c=2s$代入可得。
\end{proof}




\begin{theorem}[托勒密不等式，Ptolemy's Inequality]
  任意凸四边形$ABCD$，有
  \begin{align}
    AB\cdot CD + AD\cdot BC\ge AC\cdot BD
  \end{align}
  当且仅当$ABCD$是圆内接四边形等号成立。
\end{theorem}
\begin{proof}
  \color{red}不会呢。
\end{proof}

\begin{theorem}[鄂尔多斯—门德尔不等式，Erdos-Mordell Inequality，E-M不等式]
  $P$是三角形$ABC$内任意一点，$P$到三角形三边的距离分别为$p,q,r$，到三顶点的距离分别是$x,y,z$，则
  \begin{align}
    x+y+z\ge 2(p+q+r)
  \end{align}
\end{theorem}
\begin{proof}
  \color{red}不会呢。
\end{proof}
