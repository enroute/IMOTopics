
\chapter{序列与级数}
\label{chap:series}

数学上，序列是被排成一列的对象。当对象是数时，就是数列。在序列里，元素之间的顺序非常重要。

\section{基本序列}
\label{sec:basic-series}

\begin{example}[等差数列，算术数列，Arithmetic Progression]
  从第二项起，每一项与其前一项的差都相等的数列称不等差数列。后一项与前一项的差称为公差。如
  \begin{align*}
    3,7,11,15,19,23,27,31,35,\cdots
  \end{align*}
\end{example}

\begin{example}等差数列
  \begin{align*}
    a_1, a_2, a_3, a_4, a_5, \cdots, a_n
  \end{align*}
  其中$\forall k>1, a_k=a_1 + (k-1)d$，$d$是公差。则该数列的和为
  \begin{align*}
    S\equiv & a_1 + a_2 + a_3 + \cdots a_n\\
          = & \frac{n(a_1+a_n)}{2}
  \end{align*}
\end{example}

\begin{example}[等比数列，几何数列，Geometric Progression]
  求无穷等比数列的和，其中比例系数$q<1$：
  \begin{align*}
    S=a + aq + aq^2 + aq^3 + \cdots
  \end{align*}
\end{example}
\begin{proof}[解]
  两边同乘以$q$，有
  \begin{eqnarray*}
            & qS=& aq + aq^2 + aq^3 + aq^4 + \cdots\\
    \implies& qS=& S - a\\
    \implies&  S=& \frac{a}{1-q}
  \end{eqnarray*}
  关于无穷级数的一个技巧在于乘以某个数后找到与原数的关系。
\end{proof}

\begin{example}[$\zeta$函数]
  $\zeta$函数是按以下无穷级数定义的函数
  \begin{align}
    \zeta(x)\equiv \frac1{1^x} + \frac1{2^x} + \frac1{3^x} + \cdots
  \end{align}
  当$x=1$时，$\zeta(1)$就是调和函数。证明当$x\ge2$时，$\zeta$函数是收敛的。
\end{example}
\begin{proof}
  显然$\zeta(x)$在$x>1$时是严格单调递减正函数，从而只需考虑$\zeta(2)$的收敛性。由
  \begin{align*}
    \frac1{k^2} \le \frac1{k(k-1)},\quad\forall k>1
  \end{align*}
  从而有$\zeta(2)$的前$n$项和为
  \begin{align*}
    \zeta(2)_n&=\frac1{1^2} + \frac1{2^2} + \frac1{3^2} + \cdots + \frac1{n^2}\\
            &\le \frac1{1^2} + \frac1{2\times(2-1)} + \frac1{3\times(3-1)} +\frac1{4\times(4-1)}+ \cdots + \frac1{n\times(n-1)}\\
            &= 1 + \left(1 - \frac12\right) + \left(\frac12 - \frac13\right) + \cdots + \left(\frac1{n-1}-\frac1n\right)\\
            &= 2 - \frac1n
  \end{align*}
  令$n\to+\infty$，有$\zeta(2)\le2$。从而$\zeta(2)$有上界，收敛。
\end{proof}

\begin{example}
  求下列级数的和：
  \begin{align*}
    q + 2q^2 + 3q^3 + 4q^4 + \cdots + nq^n
  \end{align*}
\end{example}
\begin{proof}[提示]
  记其和为$S_n$，则
  \begin{align*}
    qS_n = q^2 + 2q^3 + 3q^4 + 4q^5 + \cdots + nq^{n+1}
  \end{align*}
  与原式相减，则有
  \begin{align*}
    S_n - qS_n = \underline{q + q^2 + q^3 + \cdots + q^n} - nq^{n+1}
  \end{align*}
  去掉首尾两项（下划线部分）后是等比级数，应用等比数列求和公式并化简可得。
\end{proof}

\begin{example}
  求和
  \begin{align*}
    \dfrac1{1\times2\times3} + \dfrac1{2\times3\times4} + \dfrac1{3\times4\times5} + \cdots + \dfrac1{n\times(n+1)\times(n+2)}
  \end{align*}
\end{example}
\begin{proof}[提示]
  利用下式拆项
  \begin{align*}
    \frac1{n(n+1)(n+2)} = \frac12 \left(\frac1{n(n+1)} - \frac1{(n+1)(n+2)}\right)&\qedhere
  \end{align*}
\end{proof}

\begin{example}[推广]
  是否有简单方法对下式求和
  \begin{align*}
    S_{n,k}=\sum_{i=1}^{n} \frac1{\prod_{j=i}^{i+k-1} j}
  \end{align*}
  如
  \begin{align*}
    S_{n,4} = \sum_{i=1}^{n}\frac1{i(i+1)(i+2)(i+3)}
  \end{align*}
\end{example}

\begin{example}
  对下式求和：
  \begin{align*}
    1\times2\times3 + 2\times3\times4 + 3\times4\times5 + \cdots + n(n+1)(n+2)
  \end{align*}
  并推广。
\end{example}

\begin{example}
  计算可知$\left\lfloor\sqrt{44}\right\rfloor=6$，$\left\lfloor\sqrt{4444}\right\rfloor=66$，其中$\left\lfloor x\right\rfloor$是指对$x$向下取整。请推广。
\end{example}
\begin{proof}[解]
  记
  \begin{align*}
    S_1&=44\\
    S_2&=4444\phantom{44}=100S_1+44\\
    S_3&=444444=100S_2+44\\
    \multicolumn{2}{c}{$\cdots$}\\
    S_n&=\phantom{444444=}100S_{n-1}+44
  \end{align*}
  其中$6<\sqrt{S_1}<7$。引用另一个序列$b_n$如下
  \begin{align*}
    b_1&=6\\
    b_2&=66\phantom{6}=10b_1 + 6\\
    b_3&=666          =10b_2 + 6\\
       &\cdots\\
    b_n&=\phantom{666=}10b_{n-1} + 6
  \end{align*}
  用数学归纳法。假设对任意$n\le k$，有
  \begin{align*}
    b_n<\sqrt{S_n}<b_n+1,\quad\text{即}\quad b_n^2 < S_n < (b_n+1)^2
  \end{align*}
  则对$n=k+1$，希望有
  \begin{align*}
    b_{k+1}^2 < S_{k+1} < (b_{k+1}+1)^2
  \end{align*}
  但上面的假设实在是太粗糙了，在后面确定$S_{k+1}$的上下界时无法得到需要的结果。针对上式，先考虑左边，有
  \begin{align*}
    b_{k+1}^2 < S_{k+1} \iff & (10b_k + 6)^2 < 100S_k + 44
                        \iff & (b_k + 0.6) ^2 < S_k + 0.44
  \end{align*}
  再考虑右边，有
  \begin{align*}
    S_{k+1} < (b_{k+1}+1)^2 \iff & 100S_k+44 < \left((10b_k+6)+1\right)^2\\
    \iff & S_k + 0.44 < (b_k+0.7)^2
  \end{align*}
  由此，将$S_n$的上下界估计再精确一点，假设对任意$n\le k$有
  \begin{align*}
    (b_k+0.6)^2 <S_k+0.44<(b_k+0.7)^2
  \end{align*}
  则对$n=k+1$，有
  \begin{align*}
    S_{k+1} + 0.44 < (b_{k+1} + 0.7)^2 \iff & 100S_k + 44 + 0.44 < (10b_k + 6 + 0.7)^2 \\
    \iff & S_k + 0.4444 < (b_k + 0.67)^2
  \end{align*}
  把$S_k+0.44<(b_k+0.7)^2$代入，有
  \begin{align*}
    S_k+0.4444 = & S_k + 0.44 + 0.0044 \\
               < & (b_k+0.7)^2 + 0.0044\\
               = &(b_k + 0.7 - 0.003)^2 + 0.0044\\
               = & (b_k+0.7)^2 - 0.006(b_k+0.7) + 0.003^2 + 0.0044
  \end{align*}
  而显然对任意正整数$b_k$有$0.006(b_k+0.7) - 0.003^2 - 0.0044>0$，从而$S_k+0.4444 < (b_k+0.7)^2$，从而有$S_{k+1}+0.44<(b_{k+1}+0.7)^2$。

  同样的可以估计$S_{k+1}$的另一个界。
  \begin{align*}
    (b_{k+1}+0.6)^2 < S_{k+1} + 0.44 \iff & (10b_k + 6 + 0.6)^2 < 100S_k + 44 + 0.44\\
    \iff & (b_k + 0.66)^2 < S_k + 0.4444
  \end{align*}
  利用$S_k + 0.44 > (b_k + 0.6)^2$的假设，有
  \begin{align*}
    S_k+ 0.4444 & > (b_k + 0.6)^2 + 0.0044\\
                & = (b_k + 0.66 -0.6)^2 + 0.0044\\
                & = (b_k + 0.66)^2 -1.2(b_k+0.66) + 0.36 + 0.0044 > (b_k + 0.66)^2
  \end{align*}
  上式最后一个不等号是因为对任意正整数和$b_k$有$-1.2(b_k+0.66)+0.36+0.0044<0$。

  最后，容易验证对于$k=1$，$6.6<\sqrt{44}\approx 6.633<6.7$，是满足假设的。
  
  也可以写出前$n$项$\sqrt{S_n}$，从而给出关于$S_n$的更精确的假设：
  \begin{align*}
    \sqrt{S_1} &= \sqrt{44}\phantom{4444} = \phantom{66}6.6332495807108\\
    \sqrt{S_2} &= \sqrt{4444}\phantom{44} = \phantom{6}66.6633332499958\\
    \sqrt{S_3} &= \sqrt{444444} = 666.66633333325
  \end{align*}
  即假设
  \begin{align*}
    b_k + 0.6 < \sqrt{S_k} < b_k + 0.7 &\qedhere
  \end{align*}  
\end{proof}

\begin{example}
  求和$1\times 1!+2\times 2! + \cdots + n\times n!.$
\end{example}
\begin{proof}[解]
  利用等式$n\times n! = (n+1)! - n!$拆项，则有
  \begin{align*}
    &1\times 1!+2\times 2! + \cdots + n\times n!\\
    ={}&(2! - 1!) + (3! - 2!) + (4! - 3!) + \cdots + \left( (n+1)! - n! \right)\\ %use ={} to keep space after =
    ={}& (n+1)! - 1! = (n+1)! - 1 &\qedhere
  \end{align*}
\end{proof}
